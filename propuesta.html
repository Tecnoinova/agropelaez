
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Propuesta · Tecno Innova · Agroequipos Pelaez</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body.modern .letter{max-width:980px;margin:0 auto;padding:48px 0 72px}
    body.modern .letter-card{border-radius:22px;border:1px solid var(--border);background:rgba(255,255,255,.04);box-shadow:0 18px 50px rgba(0,0,0,.28);overflow:hidden}
    body.modern .letter-head{position:relative;display:flex;align-items:center;justify-content:space-between;gap:16px;padding:22px 22px;border-bottom:1px solid rgba(255,255,255,.10);background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      box-shadow: inset 0 1px 0 rgba(255,255,255,.08);
    }
    html[data-theme="light"] body.modern .letter-head{background:linear-gradient(180deg, rgba(17,24,39,.04), rgba(17,24,39,.02));box-shadow: inset 0 1px 0 rgba(17,24,39,.06)}
    body.modern .letter-head::after{content:"";position:absolute;left:0;right:0;bottom:0;height:4px;
      background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);opacity:.95;
    }
    body.modern .letter-brand{display:flex;align-items:center;gap:14px}
    body.modern .letter-brand img{width:48px;height:48px;border-radius:16px;object-fit:contain;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.10)}
    html[data-theme="light"] body.modern .letter-brand img{background:rgba(17,24,39,.04);border-color:rgba(17,24,39,.10)}
    body.modern .letter-brand strong{display:block;color:var(--text);font-weight:950;letter-spacing:.2px}
    body.modern .letter-brand small{display:block;color:var(--muted);font-weight:850;letter-spacing:.12em;text-transform:uppercase}
    body.modern .letter-meta{display:flex;flex-direction:column;align-items:flex-end;gap:4px;color:var(--muted);font-weight:800}
    body.modern .letter-meta b{color:var(--text);font-weight:950}
    body.modern .letter-body{padding:24px 22px 10px}
    body.modern .letter-body h1{margin:0 0 10px;font-size:clamp(22px,2.8vw,30px);letter-spacing:-.02em;color:var(--text)}
    body.modern .letter-body p{margin:12px 0;color:var(--muted);line-height:1.75}
    body.modern .sub{margin:8px 0 0;color:var(--muted);max-width:70ch}
    body.modern .sub.remate{margin:26px auto 0;text-align:center;max-width:75ch;color:var(--muted);font-weight:700}
    body.modern .sub.remate::before{content:"";display:block;width:140px;height:4px;margin:0 auto 12px;
      background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);border-radius:999px;opacity:.95}
    body.modern .hero-collage{margin-top:16px;display:grid;grid-template-columns:1.25fr .75fr;gap:14px}
    /* System demo (terminal + docs) */
    .demo-surface{position:relative;border-radius:18px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.03);overflow:hidden;min-height:clamp(200px, 32vh, 340px);box-shadow:0 10px 26px rgba(0,0,0,.18)}
    html[data-theme="light"] .demo-surface{border-color:rgba(17,24,39,.10);background:rgba(17,24,39,.02)}
    .terminal{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;color:#e5e7eb;background:linear-gradient(180deg, rgba(2,6,23,.9), rgba(2,6,23,.78));height:100%;display:flex;flex-direction:column;font-size:13px}
    html[data-theme="light"] .terminal{color:#111827;background:linear-gradient(180deg, rgba(243,244,246,.9), rgba(229,231,235,.85))}
    .term-head{display:flex;align-items:center;gap:8px;padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.12)}
    html[data-theme="light"] .term-head{border-color:rgba(17,24,39,.10)}
    .term-dot{width:10px;height:10px;border-radius:999px}
    .term-dot.red{background:#ef4444}.term-dot.yellow{background:#f59e0b}.term-dot.green{background:#10b981}
    .term-body{padding:10px 12px;flex:1;overflow:hidden}
    .line{opacity:.95}
    .line .prompt{color:#22d3ee;font-weight:700}
    .line .cmd{color:#a78bfa;font-weight:800}
    .line .opt{color:#60a5fa}
    .line .val{color:#f472b6}
    .line .num{color:#34d399}
    .caret{display:inline-block;width:10px;height:16px;background:#22d3ee;margin-left:2px;animation:blink 1s steps(1) infinite}
    @keyframes blink{50%{opacity:0}}
    .shot-stack.demo-stack{display:grid;grid-template-rows:1fr 1fr;gap:14px}
    /* Cinematic flow */
    .flow-surface{position:relative;padding:16px;min-height:clamp(220px, 36vh, 360px)}
    .flow-svg{position:absolute;inset:0;width:100%;height:100%;pointer-events:none}
    .flow-node{position:absolute;min-width:140px;max-width:200px;padding:10px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.14);
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));box-shadow:var(--shadow);opacity:0;transform:scale(.92);transition:opacity .45s ease, transform .45s ease}
    html[data-theme="light"] .flow-node{border-color:rgba(17,24,39,.10);background:linear-gradient(180deg, rgba(255,255,255,.98), rgba(248,250,252,.94))}
    .flow-node b{display:block;color:var(--text);letter-spacing:.10em;text-transform:uppercase;font-size:12px;margin-bottom:4px}
    .flow-node span{color:var(--muted);font-weight:700}
    .flow-node.show{opacity:1;transform:none}
    .flow-edge{fill:none;stroke:url(#flowGrad);stroke-width:3.5;stroke-linecap:round;stroke-linejoin:round;filter:drop-shadow(0 1px 6px rgba(0,0,0,.18))}
    .flow-dot{fill:#3b82f6; transform-box: fill-box; transform-origin: center}
    .flow-dot.blink{animation:blink 2.4s infinite}
    .flow-dot.throb{animation:throb 1.8s ease-in-out infinite}
    @keyframes throb{0%{transform:scale(0.92);opacity:.9}50%{transform:scale(1.08);opacity:1}100%{transform:scale(0.92);opacity:.9}}
    .flow-node.pulse{box-shadow:0 0 0 0 rgba(59,130,246,.35);animation:pulseNode 1.6s ease-out}
    @keyframes pulseNode{0%{box-shadow:0 0 0 0 rgba(59,130,246,.45)}70%{box-shadow:0 0 0 18px rgba(59,130,246,0)}100%{box-shadow:0 0 0 0 rgba(59,130,246,0)}}
    .flow-switch{position:absolute;right:12px;top:12px;z-index:2;display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);font-weight:800;color:var(--text);font-size:12px}
    html[data-theme="light"] .flow-switch{border-color:rgba(17,24,39,.12);background:rgba(17,24,39,.04)}
    .flow-switch button{appearance:none;border:0;background:transparent;color:var(--text);font-weight:900;cursor:pointer}
    .flow-switch .pill{padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.08)}
    html[data-theme="light"] .flow-switch .pill{border-color:rgba(17,24,39,.12);background:rgba(17,24,39,.06)}
    .doc-scene{position:relative;min-height:clamp(220px, 32vh, 340px);padding-bottom:6px}
    .doc-card{position:absolute;right:10px;left:10px;top:10px;border-radius:14px;padding:10px;border:1px solid rgba(255,255,255,.14);background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));box-shadow:var(--shadow);transform:translateY(12px) scale(.98);opacity:0}
    html[data-theme="light"] .doc-card{border-color:rgba(17,24,39,.10);background:linear-gradient(180deg, rgba(255,255,255,.98), rgba(248,250,252,.94))}
    .doc-card b{display:block;color:var(--text);font-size:12px;letter-spacing:.10em;text-transform:uppercase;margin-bottom:6px}
    .doc-meta{display:flex;gap:8px;flex-wrap:wrap;color:var(--muted);font-size:12px}
    .doc-pill{padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.06)}
    html[data-theme="light"] .doc-pill{border-color:rgba(17,24,39,.12);background:rgba(17,24,39,.04)}
    .doc-card.show{opacity:1;transform:none;transition:opacity .45s ease, transform .45s ease}
    .doc-card:nth-child(1){top:6%}
    .doc-card:nth-child(2){top:34%}
    .doc-card:nth-child(3){top:62%}
    body.modern .shot{border-radius:18px;overflow:hidden;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.03);position:relative;min-height:220px}
    html[data-theme="light"] body.modern .shot{border-color:rgba(17,24,39,.10);background:rgba(17,24,39,.02)}
    body.modern .shot::after{content:"";position:absolute;inset:0;background:linear-gradient(180deg, transparent 45%, rgba(0,0,0,.45) 100%)}
    html[data-theme="light"] body.modern .shot::after{background:linear-gradient(180deg, transparent 45%, rgba(17,24,39,.28) 100%)}
    body.modern .shot img{width:100%;height:100%;object-fit:cover;display:block;transform:scale(1.02)}
    body.modern .shot .cap{position:absolute;left:14px;right:14px;bottom:12px;z-index:2;display:flex;flex-direction:column;gap:4px}
    body.modern .shot .cap b{color:var(--text);font-weight:950;letter-spacing:.10em;text-transform:uppercase;font-size:12px}
    body.modern .shot .cap span{color:rgba(255,255,255,.86);font-weight:750}
    html[data-theme="light"] body.modern .shot .cap span{color:rgba(17,24,39,.86)}
    body.modern .shot-stack{display:grid;grid-template-rows:1fr 1fr;gap:14px}
    body.modern .cap-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px;margin-top:18px}
    body.modern .cap-card{grid-column:span 6;border-radius:18px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.03);padding:14px 14px;display:flex;gap:12px;align-items:flex-start}
    html[data-theme="light"] body.modern .cap-card{border-color:rgba(17,24,39,.10);background:rgba(17,24,39,.02)}
    body.modern .cap-ico{width:40px;height:40px;border-radius:14px;display:grid;place-items:center;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.04)}
    html[data-theme="light"] body.modern .cap-ico{border-color:rgba(17,24,39,.10);background:rgba(17,24,39,.03)}
    body.modern .cap-ico svg{width:20px;height:20px;stroke:var(--text);opacity:.95}
    body.modern .cap-card h3{margin:0 0 4px;font-size:14px;letter-spacing:.08em;text-transform:uppercase}
    body.modern .cap-card p{margin:0;color:var(--muted);line-height:1.65}
    body.modern .cap-card .mini{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
    body.modern .cap-card .mini .pill{font-size:11px}
    body.modern .value-row{margin-top:18px;display:grid;grid-template-columns:1fr 1fr;gap:14px}
    body.modern .value{position:relative;overflow:hidden;border-radius:18px;padding:16px 16px;color:var(--muted);
      background: linear-gradient(180deg, var(--glass-1, rgba(255,255,255,.06)), transparent);
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 10px 26px rgba(0,0,0,.20), inset 0 1px 0 rgba(255,255,255,.08);
      transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
    }
    html[data-theme="light"] body.modern .value{border-color:rgba(17,24,39,.12);background:linear-gradient(180deg, rgba(17,24,39,.03), rgba(17,24,39,.0))}
    body.modern .value::before{content:"";position:absolute;inset:0 0 auto 0;height:4px;
      background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
      opacity:.95;
    }
    body.modern .value::after{content:"";position:absolute;right:-20%;bottom:-40%;width:60%;height:120%;
      background: radial-gradient(50% 50% at 50% 50%, rgba(255,255,255,.16), transparent 60%);
      transform: rotate(12deg);
    }
    body.modern .value:hover{transform: translateY(-4px);box-shadow: 0 16px 40px rgba(0,0,0,.28)}
    body.modern .value-row .value:nth-child(odd){border-color: rgba(59,130,246,.35)}
    body.modern .value-row .value:nth-child(even){border-color: rgba(236,72,153,.35)}
    body.modern .value b{display:block;color:var(--text);margin-bottom:6px;letter-spacing:.10em;text-transform:uppercase;font-size:12px}
    body.modern .letter-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:18px}
    body.modern .letter-panel{position:relative;overflow:hidden;border-radius:18px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.03);padding:16px 16px;
      box-shadow: 0 10px 26px rgba(0,0,0,.16), inset 0 1px 0 rgba(255,255,255,.06);
    }
    html[data-theme="light"] body.modern .letter-panel{border-color:rgba(17,24,39,.10);background:rgba(17,24,39,.02)}
    body.modern .letter-panel::after{content:"";position:absolute;inset:auto 0 0 0;height:4px;
      background: linear-gradient(90deg, #ec4899, #8b5cf6, #3b82f6);
      opacity:.95;
    }
    body.modern .letter-panel h2{margin:0 0 8px;font-size:13px;letter-spacing:.14em;text-transform:uppercase;color:var(--text)}
    body.modern .letter-list{margin:0;padding-left:18px;color:var(--muted);line-height:1.7}
    body.modern .letter-foot{padding:14px 22px 22px;border-top:1px solid rgba(255,255,255,.10);display:flex;align-items:flex-end;justify-content:space-between;gap:14px;flex-wrap:wrap}
    body.modern .sig{display:flex;flex-direction:column;gap:2px}
    body.modern .sig b{color:var(--text);font-weight:950}
    body.modern .sig span{color:var(--muted);font-weight:800}

    /* Reveal on scroll */
    .reveal{opacity:0;transform:translateY(12px);transition:opacity .5s ease, transform .5s ease;will-change:opacity, transform}
    .reveal.show{opacity:1;transform:none}
    .value.reveal{transition-delay:.05s}
    .value.reveal:nth-child(2){transition-delay:.12s}
    .letter-panel.reveal{transition-delay:.08s}
    .letter-grid .letter-panel.reveal:nth-child(2){transition-delay:.16s}
    body.modern .cta{display:flex;gap:10px;flex-wrap:wrap}
    @media (max-width: 900px){
      body.modern .letter-grid{grid-template-columns:1fr}
      body.modern .hero-collage{grid-template-columns:1fr}
      body.modern .shot-stack{grid-template-rows:auto}
      body.modern .cap-card{grid-column:span 12}
      body.modern .value-row{grid-template-columns:1fr}
      body.modern .letter-meta{align-items:flex-start}
      body.modern .letter-head{flex-direction:column;align-items:flex-start}
    }
    /* Ajuste para pantallas con poca altura: comprimir demo para que quepa sin scroll a 100% */
    @media (max-height: 820px){
      body.modern .letter-head{padding:18px 18px}
      body.modern .letter-body{padding:18px 18px 8px}
      body.modern .hero-collage{margin-top:12px;gap:10px;grid-template-columns:1.2fr .8fr}
      .terminal{font-size:12px}
      .term-head{padding:8px 10px}
      .term-body{padding:8px 10px}
      .demo-surface{min-height:clamp(170px, 28vh, 300px)}
      .flow-surface{padding:12px;min-height:clamp(190px, 32vh, 320px)}
      .doc-scene{min-height:clamp(190px, 30vh, 300px);padding-bottom:4px}
      .doc-card{padding:8px}
      .doc-card:nth-child(1){top:3.5%}
      .doc-card:nth-child(2){top:31%}
      .doc-card:nth-child(3){top:58.5%}
    }
    @media (max-height: 760px){
      body.modern .letter-head{padding:14px 16px}
      body.modern .letter-body h1{margin:0 0 6px;font-size:clamp(20px,2.3vw,28px)}
      body.modern .letter-body p.sub{margin:6px 0}
      body.modern .hero-collage{margin-top:10px;gap:8px;grid-template-columns:1.18fr .82fr}
      .terminal{font-size:11.5px}
      .demo-surface{min-height:clamp(160px, 26vh, 280px)}
      .flow-surface{padding:10px;min-height:clamp(180px, 30vh, 300px)}
      .doc-scene{min-height:clamp(180px, 28vh, 280px)}
      .doc-card{padding:7px}
      .shot-stack.demo-stack{gap:10px}
    }
    @media (max-height: 680px){
      body.modern .letter-head{padding:12px 14px}
      body.modern .letter-body{padding:12px 14px 6px}
      body.modern .hero-collage{margin-top:8px;gap:6px;grid-template-columns:1.16fr .84fr}
      .terminal{font-size:11px}
      .term-head{padding:6px 8px}
      .term-body{padding:6px 8px}
      .demo-surface{min-height:clamp(150px, 24vh, 260px)}
      .flow-surface{padding:8px;min-height:clamp(170px, 28vh, 280px)}
      .doc-scene{min-height:clamp(170px, 26vh, 260px)}
      .doc-card:nth-child(1){top:3%}
      .doc-card:nth-child(2){top:30%}
      .doc-card:nth-child(3){top:57%}
    }
    
    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }
    
    .modal-bubble {
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
      border-radius: 24px;
      padding: 32px;
      max-width: 480px;
      width: 90%;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.2);
      transform: scale(0.8) translateY(20px);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    html[data-theme="light"] .modal-bubble {
      background: linear-gradient(135deg, rgba(255,255,255,0.98), rgba(248,250,252,0.95));
      box-shadow: 0 20px 60px rgba(0,0,0,0.15), 0 0 0 1px rgba(0,0,0,0.1);
    }
    
    .modal-overlay.show .modal-bubble {
      transform: scale(1) translateY(0);
    }
    
    .modal-bubble::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
    }
    
    .modal-icon {
      width: 64px;
      height: 64px;
      margin: 0 auto 20px;
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .modal-title {
      font-size: 24px;
      font-weight: 900;
      color: #1f2937;
      margin: 0 0 12px;
      letter-spacing: -0.02em;
    }
    
    html[data-theme="light"] .modal-title {
      color: #111827;
    }
    
    .modal-message {
      font-size: 16px;
      color: #6b7280;
      line-height: 1.6;
      margin: 0 0 28px;
    }
    
    html[data-theme="light"] .modal-message {
      color: #4b5563;
    }
    
    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: center;
    }
    
    .modal-btn {
      padding: 12px 24px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 14px;
      text-decoration: none;
      transition: all 0.2s ease;
      cursor: pointer;
      border: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    .modal-btn-secondary {
      background: rgba(107, 114, 128, 0.1);
      color: #6b7280;
      border: 1px solid rgba(107, 114, 128, 0.2);
    }
    
    .modal-btn-secondary:hover {
      background: rgba(107, 114, 128, 0.15);
      color: #4b5563;
    }
    
    .modal-btn-primary {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      color: white;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }
    
    .modal-btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
    }
  </style>
</head>
<body class="modern">
  <main class="container">
    <section class="letter" aria-label="Carta de presentación">
      <div class="letter-card">
        <div class="letter-head">
          <div class="letter-brand" aria-label="Olmeca Code">
            <img src="img/uploads/2021/09/agroequipos-pelaez-logo-transparente-2.png" alt="Olmeca Code" />
            <div>
              <strong>Tecno Innova</strong>
              <small>Implementación de sistemas</small>
            </div>
          </div>
          <div class="letter-meta" aria-label="Metadatos">
            <div><b>Para:</b> Agroequipos Pelaez</div>
            <div><b>Asunto:</b> Implementación ERP + Sitio</div>
            <div><b>Fecha:</b> <span id="proposal-date"></span></div>
          </div>
        </div>

        <div class="letter-body">
          <h1>Una operación más rápida, clara y controlada</h1>
          <p class="sub">
            Implementamos para <strong>Agroequipos Pelaez</strong> un sistema que conecta <strong>Ventas</strong>, <strong>Inventario</strong> y <strong>Envíos</strong> con trazabilidad y documentos listos para imprimir/PDF.
          </p>

          <div class="hero-collage" aria-label="Vista general del sistema">
            <!-- Panel grande con animación "cinematográfica" del flujo -->
            <div class="demo-surface flow-surface" aria-label="Vista general" id="flow-surface">
              <div class="flow-switch" aria-label="Cambiar disposición">
                <span class="pill" id="flow-mode-label">Circular</span>
                <button id="flow-toggle" title="Cambiar a Escalera">Cambiar</button>
              </div>
              <svg class="flow-svg" id="flow-svg" viewBox="0 0 1000 600" preserveAspectRatio="none">
                <defs>
                  <linearGradient id="flowGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" stop-color="#3b82f6" />
                    <stop offset="50%" stop-color="#8b5cf6" />
                    <stop offset="100%" stop-color="#ec4899" />
                  </linearGradient>
                  <marker id="arrowGrad" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
                    <path d="M 0 0 L 10 5 L 0 10 z" fill="url(#flowGrad)" />
                  </marker>
                </defs>
              </svg>
              <div class="flow-node" id="n1" style="left:6%;top:12%">
                <b>Captura</b>
                <span>Orden de venta</span>
              </div>
              <div class="flow-node" id="n2" style="left:38%;top:12%">
                <b>Validación</b>
                <span>Inventario</span>
              </div>
              <div class="flow-node" id="n3" style="left:70%;top:6%">
                <b>Documentos</b>
                <span>OC / OS / Garantía</span>
              </div>
              <div class="flow-node" id="n4" style="left:70%;top:32%">
                <b>Transporte / Envío</b>
                <span>Ruta y costos</span>
              </div>
              <div class="flow-node" id="n5" style="left:38%;top:56%">
                <b>Entrega</b>
                <span>Envío programado</span>
              </div>
            </div>

            <!-- Pila de documentos animados -->
            <div class="shot-stack demo-stack" aria-label="Documentos del sistema">
              <div class="demo-surface" aria-label="Terminal del sistema">
                <div class="terminal" id="demo-terminal">
                  <div class="term-head">
                    <span class="term-dot red"></span>
                    <span class="term-dot yellow"></span>
                    <span class="term-dot green"></span>
                  </div>
                  <div class="term-body" id="term-body" aria-live="polite"></div>
                </div>
              </div>
              <div class="demo-surface doc-scene" id="doc-scene">
                <div class="doc-card"><b>Orden de venta</b><div class="doc-meta"><span class="doc-pill">OV-1024</span><span class="doc-pill">Cliente: EP-001</span><span class="doc-pill">$ 245,000</span></div></div>
                <div class="doc-card"><b>Garantía</b><div class="doc-meta"><span class="doc-pill">REM-7001</span><span class="doc-pill">Serie: A12-9X</span><span class="doc-pill">PDF</span></div></div>
                <div class="doc-card"><b>Envío</b><div class="doc-meta"><span class="doc-pill">Ruta: MX-NL</span><span class="doc-pill">Mapa</span><span class="doc-pill">ETA 48h</span></div></div>
              </div>
            </div>
          </div>

          <div class="cap-grid" aria-label="Capacidades del sistema">
            <div class="cap-card">
              <div class="cap-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 4h7v6H3z" />
                  <path d="M14 4h7v6h-7z" />
                  <path d="M3 14h7v6H3z" />
                  <path d="M14 14h7v6h-7z" />
                </svg>
              </div>
              <div>
                <h3>ERP + CRM</h3>
                <p>Gestión integral de clientes, ventas y operación en un solo lugar.</p>
                <div class="mini">
                  <span class="pill">Clientes</span>
                  <span class="pill">Seguimiento</span>
                  <span class="pill">Cotizaciones</span>
                </div>
              </div>
            </div>
            <div class="cap-card">
              <div class="cap-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M8 7V6a4 4 0 0 1 8 0v1" />
                  <path d="M6 7h12l-1 14H7L6 7Z" />
                  <path d="M9 11h6" />
                </svg>
              </div>
              <div>
                <h3>Ventas</h3>
                <p>Captura de orden, edición en modal y totales automáticos.</p>
                <div class="mini">
                  <span class="pill">Orden editable</span>
                  <span class="pill">Cliente buscable</span>
                  <span class="pill">Timestamps</span>
                </div>
              </div>
            </div>

            <div class="cap-card">
              <div class="cap-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 3h18v6H3z" />
                  <path d="M3 9h18v12H3z" />
                  <path d="M7 13h10" />
                  <path d="M7 17h6" />
                </svg>
              </div>
              <div>
                <h3>Inventario</h3>
                <p>Catálogo por SKU, existencias y descuento automático al vender.</p>
                <div class="mini">
                  <span class="pill">Stock</span>
                  <span class="pill">Precios</span>
                  <span class="pill">Validación</span>
                </div>
              </div>
            </div>

            <div class="cap-card">
              <div class="cap-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 21s7-4.4 7-11a7 7 0 1 0-14 0c0 6.6 7 11 7 11Z" />
                  <path d="M12 10.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" />
                </svg>
              </div>
              <div>
                <h3>Envíos con mapa</h3>
                <p>Dirección con autocompletado y soporte internacional cuando se requiera.</p>
                <div class="mini">
                  <span class="pill">Solo MX / Internacional</span>
                  <span class="pill">Ubicación copiable</span>
                </div>
              </div>
            </div>

            <div class="cap-card">
              <div class="cap-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M7 3h10v6H7z" />
                  <path d="M5 9h14v12H5z" />
                  <path d="M8 13h8" />
                  <path d="M8 17h5" />
                </svg>
              </div>
              <div>
                <h3>Garantía / PDF</h3>
                <p>Documento imprimible con logo, comprador, dirección y evidencia.</p>
                <div class="mini">
                  <span class="pill">Logo</span>
                  <span class="pill">Datos del comprador</span>
                  <span class="pill">PDF</span>
                </div>
              </div>
            </div>

            <div class="cap-card">
              <div class="cap-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 13h18" />
                  <path d="M5 17h14l-2 4H7l-2-4Z" />
                  <path d="M6 13V9a3 3 0 0 1 3-3h6a3 3 0 0 1 3 3v4" />
                </svg>
              </div>
              <div>
                <h3>Remolques</h3>
                <p>Diseño y fabricación de remolques a medida.</p>
                <div class="mini">
                  <span class="pill">Cama baja</span>
                  <span class="pill">Reforzados</span>
                </div>
              </div>
            </div>

            <div class="cap-card">
              <div class="cap-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M2 17h20" />
                  <path d="M4 17l2-6h12l2 6" />
                  <path d="M8 11V7h8v4" />
                </svg>
              </div>
              <div>
                <h3>Remolques ganaderos</h3>
                <p>Tipo jaula y cuello de ganso, seguridad y confort animal.</p>
                <div class="mini">
                  <span class="pill">Tipo jaula</span>
                  <span class="pill">Cuello de ganso</span>
                </div>
              </div>
            </div>

            <div class="cap-card">
              <div class="cap-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M6 20V6l6-3 6 3v14" />
                  <path d="M9 14h6" />
                  <path d="M9 10h6" />
                </svg>
              </div>
              <div>
                <h3>Fierros para marcar</h3>
                <p>Marcas personalizadas, acero grado alimenticio.</p>
                <div class="mini">
                  <span class="pill">Letras/números</span>
                  <span class="pill">Diseño a medida</span>
                </div>
              </div>
            </div>
          </div>

          <div class="value-row" aria-label="Beneficios">
            <div class="value reveal">
              <b>Menos errores</b>
              Stock validado al vender. Cambios con historial y consistencia.
            </div>
            <div class="value reveal">
              <b>Más velocidad</b>
              Menos clicks, búsqueda rápida y edición inmediata de órdenes.
            </div>
          </div>

          <div class="letter-grid" aria-label="Siguiente evolución">
            <div class="letter-panel reveal">
              <h2>Lo que sigue</h2>
              <ul class="letter-list">
                <li>ID automático de clientes (C-001) y datos completos.</li>
                <li>Series por unidad (items) para certificados por producto.</li>
                <li>Costos logísticos, impuestos y reglas por destino.</li>
                <li>Usuarios/roles y reportes.</li>
              </ul>
            </div>

            <div class="letter-panel reveal">
              <h2>Entrega</h2>
              <ul class="letter-list">
                <li>Implementación por etapas (funcional desde el primer entregable).</li>
                <li>Entrenamiento rápido a personal (ventas / almacén).</li>
                <li>Plantillas de documentos (garantía / orden) listas para usar.</li>
              </ul>
            </div>
          </div>

          <p class="sub remate">
            Nuestro compromiso: una solución que se sienta <strong>de Agroequipos Pelaez</strong>. Clara, rápida y lista para operar.
          </p>
        </div>

        <div class="letter-foot">
          <div class="sig" aria-label="Firma">
            <b>Tecno Innova</b>
            <span>Equipo de implementación</span>
          </div>
          <div class="cta" aria-label="Acciones">
            <a class="btn" href="#" onclick="showSiteWarning(); return false;">Ver sitio</a>
            <a class="btn btn-primary" href="#" onclick="showSystemWarning(); return false;">Ir a Ventas (ERP)</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal -->
  <div id="warningModal" class="modal-overlay">
    <div class="modal-bubble">
      <div class="modal-icon">⚠️</div>
      <h3 class="modal-title" id="modalTitle">Aviso Importante</h3>
      <p class="modal-message" id="modalMessage"></p>
      <div class="modal-actions">
        <button class="modal-btn modal-btn-secondary" onclick="closeModal()">Cancelar</button>
        <button class="modal-btn modal-btn-primary" id="continueBtn" onclick="proceedToDestination()">Continuar →</button>
      </div>
    </div>
  </div>

  <footer style="background: rgba(17,24,39,0.95); color: rgba(255,255,255,0.8); text-align: center; padding: 20px 0; margin-top: 40px; border-top: 1px solid rgba(255,255,255,0.1);">
    <div class="container">
      <p style="margin: 0; font-size: 14px; font-weight: 600;">Desarrollado por <strong style="color: #fff;">Tecnoinova</strong> & <strong style="color: #fff;">OLMECA CODE</strong></p>
    </div>
  </footer>

  <script>
    (function(){
      var el = document.getElementById('proposal-date');
      if (el) el.textContent = new Date().toLocaleDateString('es-MX', { year:'numeric', month:'long', day:'numeric' });
      try{
        var t = localStorage.getItem('theme');
        if (t) document.documentElement.setAttribute('data-theme', t);
      }catch(e){}
    })();

    // Cinematic flow: dibujar aristas y revelar nodos con stagger
    (function(){
      var svg = document.getElementById('flow-svg');
      var surface = document.getElementById('flow-surface');
      var n1 = document.getElementById('n1');
      var n2 = document.getElementById('n2');
      var n3 = document.getElementById('n3');
      var n4 = document.getElementById('n4');
      var n5 = document.getElementById('n5');
      if (!svg || !n1) return;

      function toLocal(x, y){
        var pt = svg.createSVGPoint(); pt.x = x; pt.y = y;
        var m = svg.getScreenCTM();
        if (m && m.inverse) return pt.matrixTransform(m.inverse());
        return pt; // fallback
      }
      function bboxLocal(el){
        var r = el.getBoundingClientRect();
        var l1 = toLocal(r.left, r.top);
        var l2 = toLocal(r.right, r.bottom);
        return { x:l1.x, y:l1.y, w:(l2.x-l1.x), h:(l2.y-l1.y) };
      }
      function midLeft(b){ return { x:b.x, y:b.y + b.h/2 }; }
      function midRight(b){ return { x:b.x + b.w, y:b.y + b.h/2 }; }
      function midTop(b){ return { x:b.x + b.w/2, y:b.y }; }
      function midBottom(b){ return { x:b.x + b.w/2, y:b.y + b.h }; }
      function topLeft(b){ return { x:b.x, y:b.y }; }
      function bottomLeft(b){ return { x:b.x, y:b.y + b.h }; }

      function cubicPath(p1, p2, kx, ky){
        var cx = p1.x + (p2.x - p1.x) * (kx==null?0.6:kx);
        var c1 = { x: cx, y: p1.y + (ky==null?32:ky) };
        var c2 = { x: cx, y: p2.y - (ky==null?32:ky) };
        return `M ${p1.x},${p1.y} C ${c1.x},${c1.y} ${c2.x},${c2.y} ${p2.x},${p2.y}`;
      }

      function pathBetween(a, b, mode){
        var ba = bboxLocal(a), bb = bboxLocal(b);
        if (mode === 'h'){
          var p1 = midRight(ba), p2 = midLeft(bb);
          return cubicPath(p1, p2, 0.5, 0);
        } else if (mode === 'v') { // vertical
          var q1 = midBottom(ba), q2 = midTop(bb);
          return cubicPath(q1, q2, 0.5, 40);
        } else if (mode === 'corner') { // de esquina inferior izquierda a esquina superior izquierda
          var c1 = bottomLeft(ba), c2 = topLeft(bb);
          var kx1 = c1.x - 28, ky1 = c1.y + 22;
          var kx2 = c2.x - 28, ky2 = c2.y - 22;
          return `M ${c1.x},${c1.y} C ${kx1},${ky1} ${kx2},${ky2} ${c2.x},${c2.y}`;
        } else { // auto: elegir por delta dominante
          var dx = (bb.x + bb.w/2) - (ba.x + ba.w/2);
          var dy = (bb.y + bb.h/2) - (ba.y + ba.h/2);
          if (Math.abs(dx) >= Math.abs(dy)){
            var p1a = dx >= 0 ? midRight(ba) : midLeft(ba);
            var p2a = dx >= 0 ? midLeft(bb) : midRight(bb);
            return cubicPath(p1a, p2a, 0.55, 0);
          } else {
            var q1a = dy >= 0 ? midBottom(ba) : midTop(ba);
            var q2a = dy >= 0 ? midTop(bb) : midBottom(bb);
            return cubicPath(q1a, q2a, 0.5, 40);
          }
        }
      }

      function addEdge(a, b, mode, opts){
        var reusePath = opts && opts.path;
        var p = reusePath || document.createElementNS('http://www.w3.org/2000/svg','path');
        if (!reusePath){
          p.setAttribute('d', pathBetween(a,b,mode));
          p.setAttribute('class','flow-edge');
          p.setAttribute('stroke-dasharray','5 9');
          p.setAttribute('opacity','0');
          p.setAttribute('marker-end','url(#arrowGrad)');
          svg.appendChild(p);
          requestAnimationFrame(function(){
            p.setAttribute('opacity','1');
            // efecto de "dibujo" del trazo
            var len = p.getTotalLength();
            p.style.strokeDasharray = len + ' ' + len;
            p.style.strokeDashoffset = len;
            p.getBoundingClientRect(); // force layout
            p.style.transition = 'stroke-dashoffset 900ms ease';
            p.style.strokeDashoffset = '0';
          });
        }

        var animate = opts && opts.animate;
        var onDone = (opts && opts.onDone) || function(){};
        if (!animate){ return p; }

        var len2 = p.getTotalLength();
        var speed = (opts && opts.speed) || 1.0; // ritmo pausado
        var dot = document.createElementNS('http://www.w3.org/2000/svg','circle');
        dot.setAttribute('r','12');
        dot.setAttribute('class','flow-dot blink throb');
        svg.appendChild(dot);
        var t = 0;
        (function step(){
          t = Math.min(t + speed, len2);
          var pt = p.getPointAtLength(t);
          dot.setAttribute('cx', pt.x);
          dot.setAttribute('cy', pt.y);
          if (t >= len2){
            dot.remove();
            b.classList.add('pulse');
            setTimeout(function(){ b.classList.remove('pulse'); onDone(); }, 380);
          } else {
            requestAnimationFrame(step);
          }
        })();
        return p;
      }

      function drawAll(mode){
        // limpiar aristas existentes
        Array.prototype.slice.call(svg.querySelectorAll('.flow-edge, .flow-dot')).forEach(function(n){ n.remove(); });
        var m = mode || currentLayout;
        var edges = (m === 'stair') ? stairEdges : circularEdges;
        // dibujar todas las aristas (estáticas) y preparar pipeline
        var paths = edges.map(function(e){ return addEdge(e[0], e[1], e[2], { animate:false }); });

        function animateEdgeAt(index, done){
          var e = edges[index];
          addEdge(e[0], e[1], e[2], { animate:true, speed:1.0, path: paths[index], onDone: done });
        }

        // pipeline: cuando un tramo termina, dispara el siguiente; al terminar el último, lanza uno nuevo desde el primero
        function startPipeline(){
          function step(k){
            animateEdgeAt(k, function(){
              // al completar tramo k, lanzar el siguiente
              var next = k + 1;
              if (next < edges.length){
                step(next);
              } else {
                // llegó al último tramo: tras una pausa corta, iniciar un nuevo dot desde el primer tramo
                setTimeout(function(){ step(0); }, 600);
              }
            });
          }
          // arranca en el primer tramo
          step(0);
        }

        startPipeline();
      }

      // Revelar nodos con escalonado
      var nodes = [n1,n2,n3,n4,n5];
      nodes.forEach(function(n,i){ setTimeout(function(){ n.classList.add('show'); }, 200 + i*180); });

      // Layouts
      var currentLayout = 'circular';
      // Posiciones circulares se calcularán dinámicamente en applyCircularLayout()
      var circularPos = [];
      var stairPos = [
        {left:'12%', top:'8%'},    // n1 Captura (fila 1)
        {left:'24%', top:'24%'},   // n2 Validación (fila 2)
        {left:'36%', top:'40%'},   // n3 Documentos (fila 3)
        {left:'48%', top:'56%'},   // n4 Transporte (fila 4)
        {left:'60%', top:'72%'}    // n5 Entrega (fila 5)
      ];

      // Aristas explícitas por layout [origen, destino, modo]
      var circularEdges = [
        [n1,n2,'auto'],
        [n2,n3,'auto'],
        [n3,n4,'auto'],
        [n4,n5,'auto']
        // retorno opcional: [n5,n1,'auto']
      ];
      var stairEdges = [
        [n1,n2,'corner'],
        [n2,n3,'corner'],
        [n3,n4,'corner'],
        [n4,n5,'corner']
      ];

      function applyLayout(mode){
        currentLayout = mode;
        if (mode === 'stair'){
          var arr = stairPos;
          [n1,n2,n3,n4,n5].forEach(function(n,i){ n.style.left = arr[i].left; n.style.top = arr[i].top; });
        } else {
          applyCircularLayout();
        }
        document.getElementById('flow-mode-label').textContent = mode === 'stair' ? 'Escalera' : 'Circular';
        var toggle = document.getElementById('flow-toggle');
        toggle.title = mode === 'stair' ? 'Cambiar a Circular' : 'Cambiar a Escalera';
        setTimeout(function(){ drawAll(mode); }, 50);
      }

      function applyCircularLayout(){
        // Coloca nodos en círculo perfecto dentro de flow-surface
        var surf = document.getElementById('flow-surface');
        var s = surf.getBoundingClientRect();
        var w = s.width, h = s.height;
        var cx = w * 0.5, cy = h * 0.5;
        var r = Math.min(w, h) * 0.36; // radio
        // Ángulos en grados desde la parte superior, en sentido horario
        var deg = [-90, -30, 20, 150, -150]; // 12, 2, 3:40, 7:30, 10
        var nodesArr = [n1,n2,n3,n4,n5];
        nodesArr.forEach(function(node, i){
          var a = deg[i] * Math.PI / 180;
          // centro del nodo
          var nx = cx + r * Math.cos(a);
          var ny = cy + r * Math.sin(a);
          // tamaño del nodo
          var nw = node.offsetWidth || 180;
          var nh = node.offsetHeight || 72;
          // top-left para posicionar por CSS
          node.style.left = (nx - nw/2) + 'px';
          node.style.top  = (ny - nh/2) + 'px';
        });
      }

      // Inicial
      setTimeout(function(){ applyLayout('circular'); }, 700);
      window.addEventListener('resize', function(){ setTimeout(function(){ drawAll(currentLayout); }, 120); });
      var toggler = document.getElementById('flow-toggle');
      if (toggler){
        toggler.addEventListener('click', function(e){
          e.stopPropagation();
          applyLayout(currentLayout === 'circular' ? 'stair' : 'circular');
        });
      }
    })();

    let currentDestination = '';

    function showSiteWarning() {
      currentDestination = 'index.html';
      document.getElementById('modalTitle').textContent = 'Sitio Web en Desarrollo';
      document.getElementById('modalMessage').textContent = 'El sitio web se encuentra en desarrollo y se realiza a medida según los requerimientos específicos de cada cliente. ¿Deseas continuar?';
      document.getElementById('warningModal').classList.add('show');
    }

    function showSystemWarning() {
      currentDestination = 'app.html#ventas';
      document.getElementById('modalTitle').textContent = 'Sistema ERP en Desarrollo';
      document.getElementById('modalMessage').textContent = 'El sistema ERP se encuentra en desarrollo y se realiza a medida según los requerimientos específicos de cada cliente. ¿Deseas continuar?';
      document.getElementById('warningModal').classList.add('show');
    }

    function closeModal() {
      document.getElementById('warningModal').classList.remove('show');
      currentDestination = '';
    }

    function proceedToDestination() {
      if (currentDestination) {
        window.location.href = currentDestination;
      }
    }

    // Close modal when clicking outside
    document.getElementById('warningModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    // Close modal with Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeModal();
      }
    });

    // Demo de terminal y documentos
    (function(){
      var box = document.getElementById('term-body');
      var docs = document.querySelectorAll('#doc-scene .doc-card');
      if (!box) return;
      function appendLine(t){
        var p = document.createElement('div');
        p.className = 'line';
        p.textContent = t;
        box.appendChild(p);
        box.scrollTop = box.scrollHeight;
      }
      function colorize(txt){
        // añadir prompt si inicia con '$ '
        var out = txt.replace(/^\$\s+/, function(m){ return '<span class="prompt">$</span> '; });
        // comandos conocidos al inicio
        out = out.replace(/(^|>\s*)(login|orden|item|calcular|generar|enviar)(?=\b)/, function(_, p1, cmd){ return p1 + '<span class="cmd">'+cmd+'</span>'; });
        // opciones tipo --flag
        out = out.replace(/(--[a-zA-Z-]+)/g, '<span class="opt">$1</span>');
        // números y montos
        out = out.replace(/(?<![A-Za-z])(\d+)(?![A-Za-z])/g, '<span class="num">$1</span>');
        // valores con guiones (SKU-xxxx, EP-001, A12-9X)
        out = out.replace(/\b([A-Z]{2,}-?[0-9A-Z-]+)\b/g, '<span class="val">$1</span>');
        return out;
      }
      function typeLine(t, cb){
        var row = document.createElement('div');
        row.className = 'line';
        var span = document.createElement('span');
        var caret = document.createElement('span');
        caret.className = 'caret';
        row.appendChild(span); row.appendChild(caret);
        box.appendChild(row);
        var i=0; var id = setInterval(function(){
          span.textContent = t.slice(0, ++i);
          box.scrollTop = box.scrollHeight;
          if (i>=t.length){ clearInterval(id); caret.remove(); span.innerHTML = colorize(span.textContent); if(cb) setTimeout(cb, 220); }
        }, 18);
      }
      function pad3(n){ return String(n).padStart(3,'0'); }
      function pick(arr, idx){ return arr[idx % arr.length]; }
      function buildScript(seq){
        var cliente = 'EP-' + pad3(seq);
        var precio = 245000 + (seq-1)*1000;
        var serie = 'A12-' + (9+((seq-1)%9)) + 'X';
        var rutas = ['MX-NL','MX-TAB','MX-JAL','MX-QRO'];
        var etas = ['24h','48h','72h'];
        var ruta = pick(rutas, seq-1);
        var eta = pick(etas, seq-1);
        return [
          'login agroequipospelaez@erop',
          'orden nueva --cliente ' + cliente,
          'item agregar SKU-4002 --cantidad 1 --precio ' + precio,
          'calcular totales',
          'generar pdf garantia --serie ' + serie,
          'enviar orden --ruta ' + ruta + ' --eta ' + eta
        ];
      }
      function updateDocs(seq){
        var cliente = 'EP-' + pad3(seq);
        var ov = 'OV-' + (1024 + (seq-1));
        var precio = 245000 + (seq-1)*1000;
        var rem = 'REM-' + (7001 + (seq-1));
        var serie = 'A12-' + (9+((seq-1)%9)) + 'X';
        var rutas = ['MX-NL','MX-TAB','MX-JAL','MX-QRO'];
        var etas = ['24h','48h','72h'];
        var ruta = pick(rutas, seq-1);
        var eta = pick(etas, seq-1);
        if (docs[0]) docs[0].innerHTML = '<b>Orden de venta</b><div class="doc-meta"><span class="doc-pill">'+ov+'</span><span class="doc-pill">Cliente: '+cliente+'</span><span class="doc-pill">$ '+precio.toLocaleString('es-MX')+'</span></div>';
        if (docs[1]) docs[1].innerHTML = '<b>Garantía</b><div class="doc-meta"><span class="doc-pill">'+rem+'</span><span class="doc-pill">Serie: '+serie+'</span><span class="doc-pill">PDF</span></div>';
        if (docs[2]) docs[2].innerHTML = '<b>Envío</b><div class="doc-meta"><span class="doc-pill">Ruta: '+ruta+'</span><span class="doc-pill">Mapa</span><span class="doc-pill">ETA '+eta+'</span></div>';
      }
      var script = [];
      var i=0;
      function hideDocs(){
        for (var k=0; k<docs.length; k++){
          // Mantener visibles entre iteraciones según solicitud; no remover 'show'
        }
      }
      var orderSeq = 1;
      function startRun(){
        box.innerHTML = '';
        i = 0;
        script = buildScript(orderSeq);
        setTimeout(step, 250);
      }
      function step(){
        if (i<script.length){ typeLine('$ '+script[i++], step); }
        else {
          // Al completar, ahora sí actualizar los documentos a la orden actual
          updateDocs(orderSeq);
          setTimeout(function(){ docs[0] && docs[0].classList.add('show'); }, 120);
          setTimeout(function(){ docs[1] && docs[1].classList.add('show'); }, 420);
          setTimeout(function(){ docs[2] && docs[2].classList.add('show'); }, 720);
          setTimeout(function(){ appendLine('✔ Proceso completado. Documentos listos.'); }, 900);
          // Reiniciar ciclo ~2s después de completar (900ms + 2000ms ≈ 2900ms)
          setTimeout(function(){ orderSeq++; startRun(); }, 2900);
        }
      }
      setTimeout(startRun, 400);
    })();

    // Distribuir dinámicamente los documentos para que siempre quepan en el contenedor
    (function(){
      var scene = document.getElementById('doc-scene');
      if (!scene) return;
      var cards = Array.prototype.slice.call(scene.querySelectorAll('.doc-card'));
      function layoutDocs(){
        if (cards.length === 0) return;
        var r = scene.getBoundingClientRect();
        var H = r.height - 16; // margen inferior de seguridad
        // medir alturas actuales de las tarjetas (ya renderizadas)
        var hs = cards.map(function(c){ return c.getBoundingClientRect().height; });
        var sumH = hs.reduce(function(a,b){ return a+b; }, 0);
        var gaps = Math.max(0, cards.length - 1);
        var gap = Math.max(10, Math.floor((H - sumH) / (gaps || 1))); // repartir espacio
        var y = 8; // padding superior
        cards.forEach(function(c, i){
          c.style.top = y + 'px';
          y += hs[i] + gap;
        });
      }
      // llamar al cargar y en redimensionar
      window.addEventListener('load', layoutDocs);
      window.addEventListener('resize', function(){
        // esperar a reflow
        setTimeout(layoutDocs, 50);
      });
      // también cuando se revelan
      setTimeout(layoutDocs, 300);
    })();

    // Reveal on scroll with IntersectionObserver
    (function(){
      var items = Array.prototype.slice.call(document.querySelectorAll('.reveal'));
      if (!('IntersectionObserver' in window) || items.length === 0) {
        items.forEach(function(n){ n.classList.add('show'); });
        return;
      }
      var io = new IntersectionObserver(function(entries){
        entries.forEach(function(entry){
          if (entry.isIntersecting) {
            requestAnimationFrame(function(){ entry.target.classList.add('show'); });
            io.unobserve(entry.target);
          }
        });
      }, { rootMargin: '0px 0px -10% 0px', threshold: 0.1 });
      items.forEach(function(n, i){
        // Small stagger via inline style delay if desired
        // n.style.transitionDelay = (i * 60) + 'ms';
        io.observe(n);
      });
    })();
  </script>
</body>
</html>

